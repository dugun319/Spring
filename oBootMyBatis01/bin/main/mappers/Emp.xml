<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.oBootMyBatis01.EmpMapper">

	<select id="EmpTotal" resultType="int">
		SELECT COUNT(*) FROM emp	
	</select> 
	
	
	
	
	
	<select id="EmpListAll" 	parameterType="Emp" 	resultType="Emp">
		SELECT * 
    		FROM (
            		SELECT ROWNUM AS rn, empAll.* 
            			FROM (SELECT * 
                    			FROM emp 
                    			ORDER BY empno DESC
                    		 ) empAll
    			  )
    		WHERE rn 
    			BETWEEN #{start} AND #{end} 	
	</select>
	
	
	
	
	
	<select id="EmpListAllRaw" 	parameterType="Emp" 	resultType="Emp">
		<![CDATA[
		SELECT * 
    		FROM (
            		SELECT ROWNUM AS rn, empAll.* 
            			FROM (SELECT * 
                    			FROM emp 
                    			ORDER BY empno DESC
                    		 ) empAll
    			  )
    		WHERE rn >= #{start} 
    		  AND rn <= #{end}
    	]]> 	
	</select>
	
	
	
	
	
	<select id="EmpSelOne"		parameterType="int" 	resultType="Emp">
		SELECT * FROM emp WHERE empno = #{empno}	
	</select>  
	
	
	
	
	
	<update id="EmpUpdate"		parameterType="Emp">
		UPDATE emp	
			SET ename 	 = #{ename},
				job	 	 = #{job},
				mgr 	 = #{mgr},
				hiredate = #{hiredate}, 
				sal 	 = #{sal},
				<if test = "#{comm} != null">
					comm 	 = #{comm},
				</if>
				deptno 	 = #{deptno}
			WHERE
				empno 	 = #{empno}
	</update>   
	
	
	
	
	
	<delete id="EmpDelete"		parameterType="int">
		DELETE FROM emp
			WHERE empno	= #{empno}
	</delete>	
	  
	  
	  
	  
	   	
	<select id="SelectManger" 	resultType="Emp">
		SELECT * 
    		FROM emp 
    		WHERE empno in (SELECT mgr
    							FROM emp)	
	</select>   	
	
	
	
	
	
	<insert id="InsertEmp"		parameterType="Emp">
		INSERT INTO emp (
						 empno,
						 ename, 
						 job, 
						 mgr, 
						 hiredate, 
						 sal, 
						 comm, 
						 deptno 
						)		
				VALUES ( 
						 #{empno},
						 #{ename},
						 #{job},
						 #{mgr},
						 #{hiredate}, 
						 #{sal},
						 #{comm},
						 #{deptno}
						)	

	</insert>
	
	
	
	
	
	<select id="CondEmpTotal" 	parameterType="Emp"		resultType="int">
		SELECT COUNT(*) FROM emp
		<choose>
			<when test="search == 's_job'">
				WHERE job LIKE '%' || #{keyword} || '%'
			</when>
			
			<when test="search == 's_ename'">
				WHERE ename LIKE '%' || #{keyword} || '%'
			</when>
			
			<otherwise>
				WHERE job LIKE '%'
			</otherwise>		
		</choose>	
	</select> 
	
	
	
	
	
	<select id="SearchEmpList" 	parameterType="Emp"		resultType="Emp">
			SELECT * 
    		FROM (
            		SELECT ROWNUM AS rn, empAll.* 
            			FROM (SELECT * 
                    			FROM emp                     			             			
                    			<choose>
									<when test="search == 's_job'">
										WHERE job LIKE '%' || #{keyword} || '%'
									</when>
									
									<when test="search == 's_ename'">
										WHERE ename LIKE '%' || #{keyword} || '%'
									</when>
									
									<otherwise>
										WHERE job LIKE '%'
									</otherwise>		
								</choose>
								
                    			ORDER BY empno DESC
                    		 ) empAll
    			  )
    		WHERE rn 
    			BETWEEN #{start} AND #{end}
			
	</select>   	
	   	
</mapper> 